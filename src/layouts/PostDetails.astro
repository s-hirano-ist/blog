---
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import type { CollectionEntry } from "astro:content";
import PostSidebar from "./PostSidebar.astro";
import Main from "@layouts/Main.astro";

/* TODO:
 * click on md file places to close nav
 * slide from the side to extract sidebar
 */

export interface Props {
  post: CollectionEntry<"blog">;
}

const { post } = Astro.props;

const { title, description } = post.data;

const { Content } = await post.render();

const ogUrl = new URL(`${title}.png`, Astro.url.origin).href;
---

<Layout title={title} description={description} ogImage={ogUrl}>
  <Header />
  <Main pageTitle={title}>
    <article
      id="article"
      role="article"
      class="prose mx-auto flex max-w-5xl flex-row"
    >
      <div id="post-side-nav" class="sidenav">
        <span class="close-sidebar-button">&times;</span>
        <PostSidebar post={post.body} />
      </div>
      <span class="open-sidebar-button">
        <svg xmlns="http://www.w3.org/2000/svg" class="scale-100">
          <path
            d="M20 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2zM4 19V7h6v12H4zm8 0V7h8V5l.002 14H12z"
          >
          </path>
          <path d="M6 10h2v2H6zm0 4h2v2H6z"></path>
        </svg>
      </span>
      <div>
        <Content />
      </div>
    </article>
  </Main>
  <script is:inline src="/toggle-sidebar.js"></script>
  <Footer />
</Layout>

<style>
  /* TODO: use tailwind */
  .sidenav {
    height: 100%; /* 100% Full-height */
    width: 0; /* 0 width - change this with JavaScript */
    position: fixed; /* Stay in place */
    z-index: 1; /* Stay on top */
    top: 0; /* Stay at the top */
    left: 0;
    background-color: #111;
    overflow-x: hidden; /* Disable horizontal scroll */
    padding-top: 60px; /* Place content 60px from the top */
    transition: 0.5s; /* 0.5 second transition effect to slide in the sidenav */
  }
  .open-sidebar-button {
    position: absolute;
    top: 64px; /* TODO: do not use px (layout to margin left incorrrect)*/
    right: 16px;
    font-size: 32px;
  }
  .close-sidebar-button {
    position: absolute;
    top: 0;
    right: 25px;
    font-size: 36px;
    margin-left: 50px;
  }
</style>
